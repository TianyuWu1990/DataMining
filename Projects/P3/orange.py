import re
import Orange as Orange
import pandas as pd
import orange
from Orange.data import Table


word = re.compile("\w+")

s = """B0090X8IPM;B003GTR8IO
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B000UBD88A;B0013A0QXC
B0041NYV8E;B002IEVJRY
B0090X8IPM;B003GTR8IO
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B0041NYV8E;B002LANN56
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B002IEZJMA;B006MONQMC
B0090X8IPM;B003GTR8IO
B002IEZJMA;B006MONQMC
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B002IEZJMA;B006MONQMC
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0090X8IPM;B003GTR8IO
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B000KV61FC;B000KV7ZGQ
B000UBD88A;B0013A0QXC
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B0090X8IPM;B003GTR8IO
B0090X8IPM;B003GTR8IO
B000UBD88A;B0013A0QXC
B000UBD88A;B0013A0QXC
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32
B000UBD88A;B0013A0QXC
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B000KV61FC;B000KV7ZGQ
B0090X8IPM;B003GTR8IO
B0013NUGDE;B007M83302;B000VK8AVK;B001RVFEP2;B0026KNQSA;B007M832YY;B0026KPDG8;B001RVFERK;B006HYLW32"""

all_items = set(word.findall(s))
domain = Orange.data.Domain([])
domain.add_metas({Orange.orange.newmetaid(): Orange.feature.Continuous(n)
                  for n in all_items}, True)

data = Orange.data.Table(domain)
for e in s.splitlines():
    ex = Orange.data.Instance(domain)
    for m in re.findall("\w+", e):
        ex[m] = 1
    data.append(ex)
# data = Table("productanduser.csv")
#
# data = pd.read_csv("productanduser.csv")
# df = pd.DataFrame(data)
# data = df
# data = Orange.data.Table("market-basket.basket")
#
rules = orange.AssociationRulesSparseInducer(data, support = 0.01)
print "%4s %4s  %s" % ("Supp", "Conf", "Rule")
count = 0
for r in rules:
    count += 1
    print "%5.3f %5.3f %s" % (r.support, r.confidence, r)
